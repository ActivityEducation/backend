import{b as D}from"./chunk-3SRKVDQM.js";import{A as H,B as V,Q as b,R as G,T as I,U as N,z as g}from"./chunk-K2P4NQMX.js";import{Fc as $,a as A,b as K,fa as U,ja as P}from"./chunk-ATHMOBVU.js";var Y=class r{constructor(d){this.http=d}apiUrl="/api/srs";submitReview(d){return console.log(`SERVICE: Submitting review for flashcard ${d.flashcardActivityPubId} with rating ${d.rating}`),this.http.post(`${this.apiUrl}/review`,d)}addToReview(d){return this.http.post(`${this.apiUrl}/add`,d)}getDueFlashcards(){return console.log("SERVICE: Fetching due flashcards from API..."),this.http.get(`${this.apiUrl}/due`)}static \u0275fac=function(l){return new(l||r)(P(D))};static \u0275prov=U({token:r,factory:r.\u0275fac})};var j=H({source:"Flashcards",events:{"Load Flashcards":g(),"Load Flashcard":g(),"Add To Review":g(),"Load Flashcard Success":g(),"Create Flashcard":g(),"Load Flashcard Failure":g(),"Load Model":g(),"Load Models":V(),"Create Model":g(),"Load Model Success":g(),"Load Model Failure":g()}});function Q(){return{ids:[],entities:{}}}function W(){function r(d={}){return Object.assign(Q(),d)}return{getInitialState:r}}function X(){function r(d){let l=f=>f.ids,y=f=>f.entities,h=b(l,y,(f,E)=>f.map(S=>E[S])),m=b(l,f=>f.length);return d?{selectIds:b(d,l),selectEntities:b(d,y),selectAll:b(d,h),selectTotal:b(d,m)}:{selectIds:l,selectEntities:y,selectAll:h,selectTotal:m}}return{getSelectors:r}}var o=function(r){return r[r.EntitiesOnly=0]="EntitiesOnly",r[r.Both=1]="Both",r[r.None=2]="None",r}(o||{});function u(r){return function(l,y){let h={ids:[...y.ids],entities:A({},y.entities)},m=r(l,h);return m===o.Both?Object.assign({},y,h):m===o.EntitiesOnly?K(A({},y),{entities:h.entities}):y}}function O(r,d){let l=d(r);return $()&&l===void 0&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",r,"The `selectId` implementation:",d.toString()),l}function q(r){function d(a,n){let e=O(a,r);return e in n.entities?o.None:(n.ids.push(e),n.entities[e]=a,o.Both)}function l(a,n){let e=!1;for(let t of a)e=d(t,n)!==o.None||e;return e?o.Both:o.None}function y(a,n){return n.ids=[],n.entities={},l(a,n),o.Both}function h(a,n){let e=O(a,r);return e in n.entities?(n.entities[e]=a,o.EntitiesOnly):(n.ids.push(e),n.entities[e]=a,o.Both)}function m(a,n){let e=a.map(t=>h(t,n));switch(!0){case e.some(t=>t===o.Both):return o.Both;case e.some(t=>t===o.EntitiesOnly):return o.EntitiesOnly;default:return o.None}}function f(a,n){return E([a],n)}function E(a,n){let t=(a instanceof Array?a:n.ids.filter(i=>a(n.entities[i]))).filter(i=>i in n.entities).map(i=>delete n.entities[i]).length>0;return t&&(n.ids=n.ids.filter(i=>i in n.entities)),t?o.Both:o.None}function S(a){return Object.assign({},a,{ids:[],entities:{}})}function T(a,n,e){let t=e.entities[n.id],i=Object.assign({},t,n.changes),s=O(i,r),c=s!==n.id;return c&&(a[n.id]=s,delete e.entities[n.id]),e.entities[s]=i,c}function B(a,n){return v([a],n)}function v(a,n){let e={};return a=a.filter(i=>i.id in n.entities),a.length>0?a.filter(s=>T(e,s,n)).length>0?(n.ids=n.ids.map(s=>e[s]||s),o.Both):o.EntitiesOnly:o.None}function x(a,n){let t=n.ids.reduce((i,s)=>{let c=a(n.entities[s]);return c!==n.entities[s]&&i.push({id:s,changes:c}),i},[]).filter(({id:i})=>i in n.entities);return v(t,n)}function C({map:a,id:n},e){let t=e.entities[n];if(!t)return o.None;let i=a(t);return B({id:n,changes:i},e)}function L(a,n){return w([a],n)}function w(a,n){let e=[],t=[];for(let c of a){let p=O(c,r);p in n.entities?t.push({id:p,changes:c}):e.push(c)}let i=v(t,n),s=l(e,n);switch(!0){case(s===o.None&&i===o.None):return o.None;case(s===o.Both||i===o.Both):return o.Both;default:return o.EntitiesOnly}}return{removeAll:S,addOne:u(d),addMany:u(l),setAll:u(y),setOne:u(h),setMany:u(m),updateOne:u(B),updateMany:u(v),upsertOne:u(L),upsertMany:u(w),removeOne:u(f),removeMany:u(E),map:u(x),mapOne:u(C)}}function Z(r,d){let{removeOne:l,removeMany:y,removeAll:h}=q(r);function m(e,t){return f([e],t)}function f(e,t){let i=e.filter(s=>!(O(s,r)in t.entities));return i.length===0?o.None:(n(i,t),o.Both)}function E(e,t){return t.entities={},t.ids=[],f(e,t),o.Both}function S(e,t){let i=O(e,r);return i in t.entities?(t.ids=t.ids.filter(s=>s!==i),n([e],t),o.Both):m(e,t)}function T(e,t){let i=e.map(s=>S(s,t));switch(!0){case i.some(s=>s===o.Both):return o.Both;case i.some(s=>s===o.EntitiesOnly):return o.EntitiesOnly;default:return o.None}}function B(e,t){return x([e],t)}function v(e,t,i){if(!(t.id in i.entities))return!1;let s=i.entities[t.id],c=Object.assign({},s,t.changes),p=O(c,r);return delete i.entities[t.id],e.push(c),p!==t.id}function x(e,t){let i=[],s=e.filter(c=>v(i,c,t)).length>0;if(i.length===0)return o.None;{let c=t.ids,p=[];return t.ids=t.ids.filter((M,F)=>M in t.entities?!0:(p.push(F),!1)),n(i,t),!s&&p.every(M=>t.ids[M]===c[M])?o.EntitiesOnly:o.Both}}function C(e,t){let i=t.ids.reduce((s,c)=>{let p=e(t.entities[c]);return p!==t.entities[c]&&s.push({id:c,changes:p}),s},[]);return x(i,t)}function L({map:e,id:t},i){let s=i.entities[t];if(!s)return o.None;let c=e(s);return B({id:t,changes:c},i)}function w(e,t){return a([e],t)}function a(e,t){let i=[],s=[];for(let M of e){let F=O(M,r);F in t.entities?s.push({id:F,changes:M}):i.push(M)}let c=x(s,t),p=f(i,t);switch(!0){case(p===o.None&&c===o.None):return o.None;case(p===o.Both||c===o.Both):return o.Both;default:return o.EntitiesOnly}}function n(e,t){e.sort(d);let i=[],s=0,c=0;for(;s<e.length&&c<t.ids.length;){let p=e[s],M=O(p,r),F=t.ids[c],J=t.entities[F];d(p,J)<=0?(i.push(M),s++):(i.push(F),c++)}s<e.length?t.ids=i.concat(e.slice(s).map(r)):t.ids=i.concat(t.ids.slice(c)),e.forEach((p,M)=>{t.entities[r(p)]=p})}return{removeOne:l,removeMany:y,removeAll:h,addOne:u(m),updateOne:u(B),upsertOne:u(w),setAll:u(E),setOne:u(S),setMany:u(T),addMany:u(f),updateMany:u(x),upsertMany:u(a),map:u(C),mapOne:u(L)}}function R(r={}){let{selectId:d,sortComparer:l}={selectId:r.selectId??(f=>f.id),sortComparer:r.sortComparer??!1},y=W(),h=X(),m=l?Z(d,l):q(d);return A(A(A({selectId:d,sortComparer:l},y),h),m)}var k=R({selectId:r=>r.activityPubId||r.id}),_={ids:[],entities:{}},bt=N(_,I(j.loadModelSuccess,(r,{data:d})=>k.upsertOne(d,r)));var tt="models",z=G(tt),et=k.getSelectors(),nt=b(z,et.selectEntities),vt=b(nt,r=>Object.values(r)),xt=r=>b(z,d=>d?.entities?.[r]??null);var it=R({selectId:r=>r.activityPubId||r.id}),rt={ids:[],entities:{}},Rt=N(rt,I(j.loadFlashcardSuccess,(r,{data:d})=>it.upsertOne(d,r)));export{j as a,bt as b,vt as c,xt as d,it as e,Rt as f,Y as g};
